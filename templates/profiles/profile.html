{% extends "base.html" %}
{% block content %}
<div class="max-w-4xl mx-auto mt-8 bg-white rounded-lg shadow p-6">

    <div class="flex items-center space-x-6 mb-6">

        <!-- Avatar -->
        {% if user.avatar %}
            <img src="{{ user.avatar.url }}" class="w-24 h-24 rounded-full object-cover border">
        {% else %}
            <div class="w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center text-gray-500">
                No avatar
            </div>
        {% endif %}

        <!-- User info -->
        <div>
            <h1 class="text-3xl font-bold text-indigo-600">{{ user.username }}</h1>

            {% if user.country %}
                <p class="text-gray-600 flex items-center space-x-2 mt-1">
                    <span>{{ user.country }}</span>
                    {% if user.country_code %}
                        <img src="https://flagcdn.com/w20/{{ user.country_code|lower }}.png"
                             alt="{{ user.country }}" class="inline-block">
                    {% endif %}
                </p>
            {% endif %}
        </div>
    </div>

    <!-- Actions -->
    <div class="flex space-x-4 mb-6">
        <a href="{% url 'users:edit_profile' %}" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition">Редактировать профиль</a>
        <a href="{% url 'reviews:add_review' %}" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition">Добавить фильм</a>
    </div>

    <!-- User's movies via reviews -->
    <h3 class="text-xl font-semibold text-gray-800 mb-3">{{ user.username }}'s movies:</h3>
    <ul class="space-y-4">
        {% for review in user.user_reviews.all %}
            <li class="flex items-start border rounded p-3 shadow-sm hover:shadow-md transition">
                {% if review.movie.poster %}
                    <img src="{{ review.movie.poster }}" alt="{{ review.movie.title }}" class="w-20 h-28 object-cover rounded mr-4">
                {% endif %}
                <div>
                    <a href="{% url 'movies:movie_detail' review.movie.id %}" class="text-indigo-600 font-semibold text-lg hover:underline">{{ review.movie.title }}</a>
                    <p class="text-gray-500">Rating: {{ review.rating }}/10</p>
                    {% if review.comment %}
                        <p class="text-gray-700 mt-1">{{ review.comment }}</p>
                    {% endif %}
                </div>
            </li>
        {% empty %}
            <li class="text-gray-500">You have not added any movies yet.</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
